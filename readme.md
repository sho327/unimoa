# 🚀 TasRepo - タスク・日報・作業ログ統合アプリ

TasRepo は、「**作業を終えたら、日報がもう書けている。**」をコンセプトに、日々のタスク管理と作業ログを一体化し、個人または小規模チームでのワークログ蓄積を自動化するアプリケーションです。

日々の作業を「記録する手間」を省きながら、ナレッジと履歴を自然に蓄積します。

## ✨ アプリケーションの概要 (Overview)

| カテゴリ         | 内容                                                               |
| :--------------- | :----------------------------------------------------------------- |
| **コンセプト**   | タスク完了をトリガーとした、作業ログ・日報の自動生成。             |
| **主な利用者**   | 個人開発者、学生（ゼミ）、友人グループ、小規模プロジェクトチーム。 |
| **コアバリュー** | 手動での報告作業を限りなくゼロにし、生産性向上に貢献。             |

### 🧩 コア機能

| 機能カテゴリ       | 概要                                                 |
| :----------------- | :--------------------------------------------------- |
| **ダッシュボード** | 今日の進捗・タスク完了数・日報サマリを一目で確認。   |
| **タスク管理**     | ToDo、担当割り当て、進捗更新。完了が作業ログに直結。 |
| **日報／作業ログ** | タスク完了履歴から自動生成。コメント・修正も可能。   |
| **グループ設定**   | グループ名、通知、日報テンプレートの管理。           |

---

## 💻 技術スタック (Tech Stack)

このプロジェクトは、最新かつ堅牢な技術スタックを用いて構築されています。

| カテゴリ            | 技術                                     | 役割                                                               |
| :------------------ | :--------------------------------------- | :----------------------------------------------------------------- |
| **フロントエンド**  | **Next.js** (App Router) / **React**     | アプリケーション基盤とコンポーネネント構築。                       |
| **バックエンド/DB** | **Supabase** (Database / Auth / Storage) | PostgreSQL DB、認証、ファイルストレージ、リアルタイム処理。        |
| **言語**            | **TypeScript**                           | 全体を通じた型安全性の確保と開発効率の向上。                       |
| **状態管理**        | **Zustand**                              | グローバルなユーザー状態（プロファイル、選択グループ）の高速管理。 |
| **UI**              | **Tailwind CSS** / **Shadcn UI**         | 高速なUI開発とコンポーネントシステム。                             |

---

## ⚙️ 起動方法 (Setup Guide)

### 1\. 依存関係のインストール

プロジェクトを開始するために、依存関係をインストールします。本プロジェクトでは **pnpm** を使用しています。

```bash
# pnpmを使用
pnpm install
```

### 2\. Supabase接続設定

プロジェクトルートに **`.env.local`** ファイルを作成し、Supabaseの接続情報を設定します。

```env
# .env.local

# ----------------------------------------
# 必須: クライアント/サーバー共通
# ----------------------------------------
NEXT_PUBLIC_SUPABASE_URL="YOUR_SUPABASE_URL"
NEXT_PUBLIC_SUPABASE_ANON_KEY="YOUR_SUPABASE_ANON_KEY"

# ----------------------------------------
# 必須: サーバーコンポーネント用
# ----------------------------------------
# RLSを無視した操作や、DBスキーマの型生成時に必要
SUPABASE_SERVICE_ROLE_KEY="YOUR_SUPABASE_SERVICE_ROLE_KEY"
```

### 3\. データベースの準備と型生成

以下の手順で、データベースのスキーマを適用し、TypeScriptの型定義を最新の状態に保ちます。

1.  **スキーマの適用**: 開発環境のSupabaseプロジェクトに、テーブル定義、RLS、そして個人グループ自動作成用の**トリガー関数**（`handle_new_user`）を含むSQLファイルを適用します。
2.  **TypeScript型の生成**: データベースの変更を反映します。

<!-- end list -->

```bash
# Supabase CLIを使用して、最新のDBスキーマからTypeScript型を生成
# 生成パスは 'src/types/Database.ts' に合わせます
supabase gen types typescript --project-id "YOUR_PROJECT_ID" > src/types/Database.ts
```

### 4\. 開発サーバーの起動

全ての準備が完了したら、開発サーバーを起動します。

```bash
npm run dev
# 以下のURLでアプリケーションにアクセスできます
# 🌐 http://localhost:3000
```

---

## 🏗️ 開発アーキテクチャの指針 (Development Guidelines)

### 型定義の責務分離

コードの保守性を高めるため、型定義は以下のルールに基づき厳密に分離されています。

| 配置ファイル                    | 責務                                                                | 例外 |
| :------------------------------ | :------------------------------------------------------------------ | :--- |
| **`src/types/Database.ts`**     | データベーススキーマの**基底型**。                                  |      |
| **`src/types/group.ts`** 他     | **汎用型**。単一テーブル (`GroupRow`、`SelectedGroup`) の定義。     |      |
| **`lib/supabase/userData.ts`** | **リレーション型**。複雑な JOIN 結果 (`ProfileWithGroups`) の定義。 |      |

### 認証フローとデータアクセス

- **RLS (Row Level Security)**: データのアクセス制御は、ユーザーの所属グループIDに基づいた RLS によりデータベースレベルで保証されています。
- **認証**: Next.jsのServer Componentで `supabase.auth.getUser()` を使用し、サーバーサイドでセッションを確立します。
- **状態管理**: **Zustandストア**は、クライアント側で頻繁に利用される認証済みユーザーデータ（`ProfileWithGroups`、`SelectedGroup`）を格納するために利用されます。

---

## 🤝 貢献と拡張性 (Contribution)

- **将来の拡張**: AIによる日報要約、Slack/Discord連携などを視野に入れています。
